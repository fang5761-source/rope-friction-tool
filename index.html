<!doctype html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>繩索纏繞摩擦力估算</title>
<meta name="apple-mobile-web-app-title" content="纏繞摩擦力估算">
<style>
:root{
  --bg:#0b1220;--panel:#121a2f;--panel2:#0f172a;--line:#233056;
  --text:#e5e7eb;--muted:#94a3b8;--accent:#38bdf8;
  --good:#22c55e;--warn:#f59e0b;--danger:#ef4444;--r:18px;
}
*{box-sizing:border-box;}
body{
  margin:0;
  background:radial-gradient(1200px 600px at 10% -20%, #1e293b 0%, transparent 50%),var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
}
.wrap{max-width:860px;margin:0 auto;padding:16px;}
.card{
  background:linear-gradient(180deg,var(--panel),var(--panel2));
  border-radius:var(--r);
  padding:18px;margin-bottom:14px;border:1px solid var(--line);
}
h1{font-size:18px;margin:0 0 6px;}
.sub{font-size:13px;color:var(--muted);line-height:1.6}
.section{font-size:15px;font-weight:900;margin-bottom:10px}
label{display:block;font-size:13px;color:#cbd5f5;margin:10px 0 6px;font-weight:700}
input,select{
  width:100%;padding:12px;border-radius:14px;border:1px solid var(--line);
  background:#020617;color:var(--text);font-size:15px;
}
.quick{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
.quick button{
  background:#020617;border:1px solid var(--line);color:var(--text);
  padding:10px;border-radius:999px;font-weight:800;
}
.actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:14px}
.actions button{padding:12px;border-radius:14px;border:0;font-weight:900;font-size:15px}
.calc{background:linear-gradient(135deg,#38bdf8,#0ea5e9);color:#020617}
.reset{background:#020617;color:#cbd5f5;border:1px solid var(--line)}
.result-main{
  text-align:center;padding:18px 12px;border-radius:var(--r);
  background:#020617;border:1px solid var(--line);
}
.big{font-size:42px;font-weight:1000;letter-spacing:.5px}
.badge{display:inline-block;padding:6px 12px;border-radius:999px;font-size:12px;font-weight:900;margin-top:6px}
.good{background:#052e16;color:#22c55e}
.mid{background:#3a2503;color:#f59e0b}
.high{background:#3b0a0a;color:#ef4444}
.small{font-size:12px;color:var(--muted);margin-top:6px}
#suggest{line-height:1.6; white-space:normal}
.kv{display:flex;justify-content:space-between;border-bottom:1px dashed var(--line);padding:10px 0}
.kv:last-child{border-bottom:0}
.explain{font-size:13px;color:#cbd5f5;line-height:1.75}
.mono{font-family:ui-monospace,monospace}
.toggle{display:flex;gap:8px;margin-top:6px}
.toggle button{
  flex:1;padding:10px;border-radius:999px;border:1px solid var(--line);
  background:#020617;color:#cbd5f5;font-weight:900
}
.toggle button.active{
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  color:#020617;border:0
}

/* Details base */
details{
  border:1px solid var(--line);
  border-radius:14px;
  background:#020617;
  padding:10px 12px;
}
details + details{margin-top:12px;}
details summary{
  cursor:pointer;
  font-weight:900;
  color:#cbd5f5;
  list-style:none;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
details summary::-webkit-details-marker{display:none;}
details summary::after{
  content:"▸";
  color:var(--muted);
  transform: rotate(0deg);
  transition: transform .15s ease;
}
details[open] summary::after{ transform: rotate(90deg); }

.collapseBtn{
  margin-top:12px;
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.04);
  color:rgba(255,255,255,.85);
  cursor:pointer;
  font-weight:900;
}

.footer{
  font-size:12px;color:#cbd5f5;
  line-height:1.6;
  padding:12px 14px;
  border:1px solid var(--line);
  border-radius:14px;
  background:#020617;
  margin-top:12px;
}
.meta{
  font-size:12px;color:#94a3b8;line-height:1.6;margin-top:8px
}
.hintInline{
  font-size:12px;
  color:var(--muted);
  margin-top:6px;
}
.hintInline .pill{
  display:inline-block;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#020617;
  margin-left:6px;
  color:var(--muted);
}
.kCustomWrap{
  display:none;
  margin-top:10px;
}
.kCustomWrap.show{
  display:block;
}
.kMini{
  font-size:12px;
  color:var(--muted);
  margin-top:6px;
  line-height:1.5;
}
</style>
</head>
<body>
<div class="wrap">

<div class="card">
<h1>繩索纏繞摩擦力估算</h1>
<div class="sub">
Rope Friction Tutor<br>
核心公式：<span class="mono">T₂ = T₁ × e^( μ × θ )</span>
</div>
</div>

<div class="card">
<div class="section">輸入條件</div>

<label>纏繞圈數 n</label>
<input id="n" type="number" step="0.01" value="1.50"/>
<div class="quick">
<button type="button" onclick="adj(-0.25)">-0.25</button>
<button type="button" onclick="adj(-0.5)">-0.5</button>
<button type="button" onclick="adj(0.25)">+0.25</button>
<button type="button" onclick="adj(0.5)">+0.5</button>
</div>

<label>摩擦條件（情境選擇）</label>
<select id="muPreset">
  <option value="0.18">繩索 ↔ 金屬（偏滑）</option>
  <option value="0.25" selected>繩索 ↔ 金屬（一般乾燥）</option>
  <option value="0.35">繩索 ↔ 樹皮（乾）</option>
  <option value="0.45">繩索 ↔ 樹皮（濕/苔/泥）</option>
  <option value="0.40">繩索 ↔ 水泥/混凝土（乾）</option>
  <option value="0.50">繩索 ↔ 水泥/混凝土（濕）</option>
  <option value="0.22">繩索 ↔ 繩索（新繩）</option>
  <option value="0.30">繩索 ↔ 繩索（舊繩／毛）</option>
  <option value="custom">自訂 μ（進階）</option>
</select>

<label style="margin-top:10px">摩擦係數 μ（可微調）</label>
<input id="muVal" type="number" step="0.01" value="0.25" inputmode="decimal"/>
<div class="kMini">建議範圍：0.05～0.80（依材質、濕度、粉塵、表面粗糙度會有明顯差異）</div>
<div class="kMini">不確定就先用「一般乾燥」或「新繩」，看倍率落在哪一個區間，再回來微調。</div>


<label>k 建議情境</label>
<select id="kSel">
<option value="0.8">穩定操作（示範 / 靜態｜站定、慢慢做）</option>
<option value="0.7" selected>一般教學（半動態｜邊講邊做、偶爾移動）</option>
<option value="0.5">動態操作（快速 / 濕滑｜走動、調整、容易滑）</option>
<option value="custom">自訂（工程判斷）</option>
</select>

<div class="kCustomWrap" id="kCustomWrap">
  <input id="kCustom" type="number" step="0.01" value="0.70" min="0.30" max="1.00" inputmode="decimal"/>
  <div class="kMini">範圍建議：0.30～1.00（貼合與受力越完整，k 越接近 1.00）</div>
</div>

<label>已知哪一端？</label>
<div class="toggle">
<button type="button" id="btnT1" class="active" onclick="setSide('T1')">已知手端 T1</button>
<button type="button" id="btnT2" onclick="setSide('T2')">已知負重端 T2</button>
</div>

<label id="forceLabel">已知拉力（T1，kgf）</label>
<input id="force" type="number" value="1"/>
<div class="hintInline">數值：<b>1</b> <span class="pill">預設值</span>（不知道填多少時，先用預設值看「倍率」就好）</div>

<div class="actions">
<button type="button" class="calc" onclick="calc()">計算</button>
<button type="button" class="reset" onclick="resetAll()">重設</button>
</div>
</div>

<div class="card">
<div class="section">結果（建議以此判斷）</div>
<div class="result-main">
<div class="small">實際建議摩擦倍率（含 k）</div>
<div class="big" id="Meff">—</div>
<div class="small">理論倍率 ×<span id="M">—</span> ｜ k = <span id="k">—</span></div>
</div>
<div style="margin-top:14px">
<div class="kv"><div>T1 手端</div><div id="outT1">—</div></div>
<div class="kv"><div>T2 負重端</div><div id="outT2">—</div></div>
</div>
</div>

<div class="card">

<details id="infoA">
<summary>第一次使用？先看這裡</summary>
<div class="explain" style="margin-top:10px">
<b>【為什麼要看摩擦力？】</b><br>
很多人會直覺地認為：<b>繩子繞多一點，就會比較安全。</b><br><br>
但在實際操作中，<b>摩擦力太大，反而可能讓操作變得困難，甚至增加風險。</b><br><br>
摩擦力影響的不是「撐不撐得住」，而是：<br>
• 放手是否順<br>
• 動作是否可控<br>
• 繩索是否過熱<br>
• 操作是否卡滯<br><br>
<b>好的繩索配置，不是追求摩擦最大，而是讓力量落在「你能控制的範圍內」。</b><br><br>

<b>【這個工具在幫你做什麼？】</b><br>
這個工具不是用來算對錯，<br>
而是幫你把「直覺」變成可以被檢視的東西。<br><br>
當你心中已經有一個繞法時，<br>
用它來看一眼：<br>
• 摩擦是不是太大？<br>
• 操作會不會變得不好放手？<br>
• 是否還在可控制範圍內？<br><br>

<b>【什麼時候不能只靠這個工具？】</b><br>
當環境快速變化、載荷不確定，<br>
或操作經驗不足時，<br>
<b>請不要只依賴數值判斷。</b><br><br>
這個工具是教學與判斷的輔助，<br>
<b>不是替代現場判斷與操作責任。</b><br><br>
<hr style="border:0;border-top:1px dashed #233056;margin:12px 0;">

<b>① 這個工具是在幫你看什麼？</b><br>
這個工具不是在幫你算「對不對」，而是在幫你看：<b>現在這樣繞，合不合理、好不好用。</b><br>
算出來的數字，代表的是「繩索把力量放大了多少倍」。<br>
<b>數字越大，不一定越安全，反而可能代表操作會變得困難。</b><br><br>

<b>② 為什麼圈數不能一直加？</b><br>
每多繞一圈，摩擦力不是慢慢增加，而是「變很快地增加」。<br>
圈數太多，常見的問題有：放手不好控制、繩索容易過熱、動作變得卡、不順。<br>
所以重點不是鼓勵你多繞，而是幫你找「剛剛好」的圈數。<br><br>

<b>③ 怎麼快速使用（30 秒版）</b><br>
1. 輸入你實際繞了幾圈（n）<br>
2. 選擇大概的摩擦情境與 k 建議情境<br>
<span style="color:#94a3b8">小提醒：不確定摩擦情境時，先選「一般乾燥」；繩索 ↔ 繩索不確定時，先選「新繩」。</span><br>
3. 看「實際建議摩擦倍率」跟下面的提示文字<br>
如果看到「偏高」或「高放大」，代表可以停下來想一想：<b>要不要少繞一點，或換一種配置。</b><br><br>

<b>④ T1 / T2 是什麼？怎麼填？</b><br>
<b>T1 / T2 不是數學題，只是讓你分清楚哪一邊出力、哪一邊承受。</b><br>
（它是在幫你看力量怎麼走）<br>
• T1：你手上「出力」的那一邊<br>
• T2：繩索最後「承受重量」的那一邊<br><br>
<b>不知道要填多少時，就先用預設值 1 看「倍率」就好。</b>

<button type="button" class="collapseBtn" data-collapse="#infoA">收合</button>
</div>
</details>

<details id="infoB" style="margin-top:12px">
<summary>K 的工程意義與使用說明</summary>
<div class="explain" style="margin-top:10px">
k 代表：<b>你繞的角度中，有多少比例真的在工作。</b><br><br>
理論公式假設每一圈都完全貼合並產生摩擦；但在實際操作中，貼合、受力分佈、動態操作與繩索狀況
都會使「有效摩擦角度」小於幾何角度。<br><br>
工程上可表示為：<br>
<span class="mono">k = θ_eff / θ_total</span>

<button type="button" class="collapseBtn" data-collapse="#infoB">收合</button>
</div>
</details>

<details id="infoC" style="margin-top:12px">
<summary>開發與版本資訊</summary>
<div class="meta">
本工具由 <b>散木團隊</b> 開發製作<br>
教學架構與工程判斷 / 徐世豐<br>
工具設計與互動介面 / 吳佩芳（朵朵）<br>「子惠繩」與子惠結之纏繞摩擦需求，為本工具之設計啟發<br>
AI 協作輔助 / ChatGPT<br>
版本 v3.10｜2026
<button type="button" class="collapseBtn" data-collapse="#infoC" style="margin-top:10px">收合</button>
</div>
</details>

</div>

<div class="footer">
【教學使用聲明】本工具為教學與風險判斷輔助使用，
所有結果皆為估算值，不得取代現場判斷、標準作業程序（SOP）與安全保護措施。
</div>

</div>

<script>
let knownSide="T1";

const n = document.getElementById("n");
const muPreset = document.getElementById("muPreset");
const muVal = document.getElementById("muVal");
const kSel = document.getElementById("kSel");
const kCustomWrap = document.getElementById("kCustomWrap");
const kCustom = document.getElementById("kCustom");
const btnT1 = document.getElementById("btnT1");
const btnT2 = document.getElementById("btnT2");
const forceLabel = document.getElementById("forceLabel");
const force = document.getElementById("force");
const M = document.getElementById("M");
const k = document.getElementById("k");
const Meff = document.getElementById("Meff");
const outT1 = document.getElementById("outT1");
const outT2 = document.getElementById("outT2");
const suggest = document.getElementById("suggest");
const badge = document.getElementById("badge");


function setSide(s){
  knownSide=s;
  btnT1.classList.toggle("active",s==="T1");
  btnT2.classList.toggle("active",s==="T2");
  forceLabel.textContent=s==="T1"?"已知拉力（T1，kgf）":"已知拉力（T2，kgf）";
}

function adj(d){ n.value=(Math.max(0,(+n.value||0)+d)).toFixed(2) }

function clamp(num, min, max){
  if(Number.isNaN(num)) return min;
  return Math.min(max, Math.max(min, num));
}

function refreshKUI(){
  const isCustom = kSel.value === "custom";
  kCustomWrap.classList.toggle("show", isCustom);
  if(isCustom){
    const cur = parseFloat(kCustom.value);
    if(Number.isNaN(cur)) kCustom.value = "0.70";
  }
}

function refreshMuUI(){
  const isCustom = muPreset.value === "custom";
  // 選到預設情境：直接帶入對應 μ，並允許微調
  if(!isCustom){
    const v = parseFloat(muPreset.value);
    if(!Number.isNaN(v)) muVal.value = v.toFixed(2);
  }
}

function getMuValue(){
  let v = parseFloat(muVal.value);
  if(Number.isNaN(v)) v = 0.25;
  // 合理夾限，避免輸入太離譜導致爆表
  v = clamp(v, 0.01, 1.20);
  muVal.value = v.toFixed(2);
  return v;
}

function getKValue(){
  if(kSel.value === "custom"){
    const v = clamp(parseFloat(kCustom.value), 0.30, 1.00);
    kCustom.value = v.toFixed(2);
    return v;
  }
  return parseFloat(kSel.value);
}

function resetAll(){
  n.value="1.50";
  muPreset.value="0.25";
  muVal.value="0.25";
  kSel.value="0.7";
  kCustom.value="0.70";
  refreshKUI();
  refreshMuUI();
  setSide("T1");
  force.value="1";
  // clear outputs
  M.textContent="—"; k.textContent="—"; Meff.textContent="—";
  outT1.textContent="—"; outT2.textContent="—";
}

function calc(){
  const nn=+n.value, muv=getMuValue(), f=+force.value;
  const kVal=getKValue();
  const theta=nn*2*Math.PI;
  const Mv=Math.exp(muv*theta);
  const Me=Mv*kVal;
  let T1,T2;
  if(knownSide==="T1"){ T1=f; T2=f*Me } else { T2=f; T1=f/Me }
  M.textContent=Mv.toFixed(2);
  k.textContent=kVal.toFixed(2);
  Meff.textContent="× "+Me.toFixed(2);
  outT1.textContent=T1.toFixed(2)+" kgf";
  outT2.textContent=T2.toFixed(2)+" kgf";
}

/* 底部「收合」按鈕：一按就收合 */
document.addEventListener("click", function(e){
  const btn = e.target.closest("[data-collapse]");
  if(!btn) return;
  const selector = btn.getAttribute("data-collapse");
  const block = document.querySelector(selector);
  if(!block) return;
  block.removeAttribute("open");
  block.querySelector("summary")?.scrollIntoView({behavior:"smooth", block:"start"});
});

// UI hooks
kSel.addEventListener("change", refreshKUI);
muPreset.addEventListener("change", ()=>{ refreshMuUI(); });
muVal.addEventListener("blur", ()=>{ /* normalize */ getMuValue(); });

resetAll(); // initialize defaults cleanly
</script>
</body>
</html>
